plugins {
    id 'war'
}

dependencies {
    compile group: 'log4j', name: 'log4j', version: '1.2.17', ext: 'jar'
    compile group: 'commons-io', name: 'commons-io', version: '2.5' 
}

repositories {
    mavenCentral()
    jcenter()
}

version='1.0.5'  //version we need to change

task increment doLast {
    group 'Other'
    description 'increment version of gradlew properties'
    def v=buildFile.getText().find(version)
    String minor=v.substring(v.lastIndexOf('.')+1) 
    int m=minor.toInteger()+1                      
    String major=v.substring(0,v.length()-1)
    String s=buildFile.getText().replaceFirst("version='$version'","version='"+major+m+"'")
    buildFile.setText(s)
}

task sourcesForRelease(type: Copy) {
    from 'src/main/resources'
    into 'build/resources/main'
    doLast {
        def outputFile = file("$buildDir/resources/main/greeting.txt")
        outputFile.write "Version: $version"
        println "processing my task"
    }    
}

classes.dependsOn sourcesForRelease







